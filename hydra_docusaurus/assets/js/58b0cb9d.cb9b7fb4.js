"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1570],{6218:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>d,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"hydra-js-client/kuber-provider/buildAndSignWithWallet","title":"buildAndSignWithWallet","description":"buildAndSignWithWallet is an asynchronous function that builds a transaction, automatically adds UTxOs from the wallet, and then signs the transaction using the provided CIP-30 compatible wallet.","source":"@site/docs/hydra-js-client/kuber-provider/buildAndSignWithWallet.md","sourceDirName":"hydra-js-client/kuber-provider","slug":"/hydra-js-client/kuber-provider/buildAndSignWithWallet","permalink":"/kuber/hydra_docusaurus/docs/hydra-js-client/kuber-provider/buildAndSignWithWallet","draft":false,"unlisted":false,"editUrl":"https://github.com/dQuadrant/kuber/tree/feat/hydra/docs/hydra-js-client/kuber-provider/buildAndSignWithWallet.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5,"sidebar_label":"buildAndSignWithWallet"},"sidebar":"hydraJsClient","previous":{"title":"buildWithWallet","permalink":"/kuber/hydra_docusaurus/docs/hydra-js-client/kuber-provider/buildWithWallet"},"next":{"title":"buildAndSubmitWithWallet","permalink":"/kuber/hydra_docusaurus/docs/hydra-js-client/kuber-provider/buildAndSubmitWithWallet"}}');var l=t(4848),r=t(8453);const a={sidebar_position:5,sidebar_label:"buildAndSignWithWallet"},d="buildAndSignWithWallet",s={},o=[{value:"Function Signature",id:"function-signature",level:2},{value:"Parameters",id:"parameters",level:2},{value:"Returns",id:"returns",level:2},{value:"Example",id:"example",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"buildandsignwithwallet",children:"buildAndSignWithWallet"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"buildAndSignWithWallet"})," is an asynchronous function that builds a transaction, automatically adds UTxOs from the wallet, and then signs the transaction using the provided CIP-30 compatible wallet."]}),"\n",(0,l.jsx)(n.h2,{id:"function-signature",children:"Function Signature"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:"async buildAndSignWithWallet(\n  cip30OrProvider: Cip30 | Cip30Provider,\n  buildRequest: Record<string, any>,\n  autoAddCollateral = false,\n  estimatedSpending?: number | bigint,\n): Promise<SignTxResult>\n"})}),"\n",(0,l.jsx)(n.h2,{id:"parameters",children:"Parameters"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"cip30OrProvider"}),": A CIP-30 compatible wallet instance or provider."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"buildRequest"}),": An object following Kuber's transaction builder JSON specification. For a comprehensive reference on transaction builder fields and their usage, please refer to the ",(0,l.jsx)(n.a,{href:"https://kuberide.com/kuber/docs/tx-builder-reference",children:"KuberIDE TxBuilder Object Reference"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"autoAddCollateral"}),": An optional ",(0,l.jsx)(n.code,{children:"boolean"})," indicating whether to automatically add collateral from the provider. Defaults to ",(0,l.jsx)(n.code,{children:"false"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"estimatedSpending"}),": An optional ",(0,l.jsx)(n.code,{children:"number"})," or ",(0,l.jsx)(n.code,{children:"bigint"})," representing the estimated amount of Lovelace to be spent."]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"returns",children:"Returns"}),"\n",(0,l.jsxs)(n.p,{children:["A ",(0,l.jsx)(n.code,{children:"Promise"})," that resolves to a ",(0,l.jsx)(n.code,{children:"SignTxResult"})," object, containing the signed transaction."]}),"\n",(0,l.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:'import { KuberHydraApiProvider } from "kuber-client";\nimport { loadCrypto, Ed25519Key } from "libcardano";\nimport { ShelleyWallet, Cip30ShelleyWallet } from "libcardano-wallet";\nimport { readFileSync } from "fs";\n\nasync function main() {\n  await loadCrypto();\n\n  const hydra = new KuberHydraApiProvider("http://localhost:8081"); // Replace with your Hydra API URL\n\n  // Load test wallet signing key\n  const testWalletSigningKey = await Ed25519Key.fromCardanoCliJson(\n    JSON.parse(readFileSync(process.env.HOME + "/.cardano/preview/hydra-0/credentials/funds.sk", "utf-8")),\n  );\n\n  // Setup libcardano crypto and Shelley wallet\n  const shelleyWallet = new ShelleyWallet(testWalletSigningKey);\n  const cip30Wallet = new Cip30ShelleyWallet(hydra, hydra, shelleyWallet, 0);\n  const walletAddress = (await cip30Wallet.getChangeAddress()).toBech32();\n\n  const transaction = {\n    outputs: [{ address: walletAddress, value: "1_000_000" }], // Sending 1 ADA\n    changeAddress: walletAddress,\n  };\n\n  try {\n    console.log("Building and signing transaction with wallet...");\n    const signedTx = await hydra.buildAndSignWithWallet(cip30Wallet, transaction);\n    console.log("Signed transaction:", signedTx);\n    console.log("Signed CBOR Hex:", signedTx.updatedTxBytes.toString(\'hex\'));\n  } catch (error) {\n    console.error("Error building and signing transaction with wallet:", error);\n  }\n}\n\nmain();\n'})})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>d});var i=t(6540);const l={},r=i.createContext(l);function a(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:a(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);