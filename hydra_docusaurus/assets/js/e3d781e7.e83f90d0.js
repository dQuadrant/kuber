"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6997],{9754:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>c,contentTitle:()=>o,default:()=>l,frontMatter:()=>r,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"sequenceDiagrams","title":"Sequence Diagrams","description":"Interaction with Hydra","source":"@site/docs/sequenceDiagrams.md","sourceDirName":".","slug":"/sequenceDiagrams","permalink":"/kuber/hydra_docusaurus/docs/sequenceDiagrams","draft":false,"unlisted":false,"editUrl":"https://github.com/dQuadrant/kuber/tree/feat/hydra/docs/sequenceDiagrams.md","tags":[],"version":"current","frontMatter":{},"sidebar":"architecture","previous":{"title":"Architecture","permalink":"/kuber/hydra_docusaurus/docs/architecture"}}');var n=t(4848),s=t(8453);const r={},o="Sequence Diagrams",c={},h=[{value:"Initialize Head",id:"initialize-head",level:4},{value:"Commit UTxOs",id:"commit-utxos",level:4},{value:"DeCommit UTxOs",id:"decommit-utxos",level:4},{value:"Close Head",id:"close-head",level:4},{value:"Query UTxOs",id:"query-utxos",level:4},{value:"Query Protocol Parameters",id:"query-protocol-parameters",level:4},{value:"Abort Head",id:"abort-head",level:4},{value:"Fanout Head",id:"fanout-head",level:4}];function d(e){const a={h1:"h1",h4:"h4",header:"header",p:"p",...(0,s.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.header,{children:(0,n.jsx)(a.h1,{id:"sequence-diagrams",children:"Sequence Diagrams"})}),"\n",(0,n.jsx)(a.p,{children:"Interaction with Hydra"}),"\n",(0,n.jsx)(a.h4,{id:"initialize-head",children:"Initialize Head"}),"\n",(0,n.jsx)(a.p,{children:"Initialization of a Hydra head is the process of setting up the offchain state channel for a group of parties. It begins with an initiator posting an initial transaction on the mainchain, which defines the head members and parameters, and forges unique participation tokens for each member."}),"\n",(0,n.jsx)("img",{alt:"Hydra head initialization sequence diagram",src:"https://raw.githubusercontent.com/dQuadrant/kuber/88c3fe0b1e721e5e4fb8e4bcd9e50f10b570f628/hydra/sequence-diagrams/init.jpg"}),"\n",(0,n.jsx)(a.h4,{id:"commit-utxos",children:"Commit UTxOs"}),"\n",(0,n.jsx)(a.p,{children:'Each member locks their chosen UTxOs onchain by posting a commit transaction, utilizing their participation token. Finally, a collectCom transaction is posted to aggregate all committed UTxOs into the initial head state and transition the mainchain state machine to the "open" state, enabling offchain processing to commence.'}),"\n",(0,n.jsx)("img",{alt:"Commit UTxOs to hydra head sequence diagram",src:"https://raw.githubusercontent.com/dQuadrant/kuber/88c3fe0b1e721e5e4fb8e4bcd9e50f10b570f628/hydra/sequence-diagrams/commit.jpg"}),"\n",(0,n.jsx)(a.h4,{id:"decommit-utxos",children:"DeCommit UTxOs"}),"\n",(0,n.jsx)(a.p,{children:"Decommitting a UTxO in Hydra means moving it out of the offchain head protocol and back onto the mainchain. This effectively makes the funds or state represented by that UTxO available for standard layer-one operations again. Decommitment can occur when the head is closed, settling the final set of UTxOs back onchain, or incrementally while the head remains open, allowing specific UTxOs to be removed without closing the entire head."}),"\n",(0,n.jsx)("img",{alt:"DeCommit UTxOs from hydra head sequence diagram",src:"https://raw.githubusercontent.com/dQuadrant/kuber/88c3fe0b1e721e5e4fb8e4bcd9e50f10b570f628/hydra/sequence-diagrams/decommit.jpg"}),"\n",(0,n.jsx)(a.h4,{id:"close-head",children:"Close Head"}),"\n",(0,n.jsx)(a.p,{children:"Closing a Hydra head means terminating the offchain state channel and settling the final agreed-upon state back onto the mainchain. This process is typically initiated by a head member posting a close transaction on the mainchain, which transitions the mainchain state machine from the open state to the closed state. This transaction includes a certificate representing that party's view of the latest confirmed offchain state."}),"\n",(0,n.jsx)("img",{alt:"Close hydra head sequence diagram",src:"https://raw.githubusercontent.com/dQuadrant/kuber/88c3fe0b1e721e5e4fb8e4bcd9e50f10b570f628/hydra/sequence-diagrams/close.jpg"}),"\n",(0,n.jsx)(a.h4,{id:"query-utxos",children:"Query UTxOs"}),"\n",(0,n.jsx)(a.p,{children:"Hydra head maintains a record of available UTxOs that can be spent."}),"\n",(0,n.jsx)("img",{alt:"Query hydra UTxOs sequence diagram",src:"https://raw.githubusercontent.com/dQuadrant/kuber/88c3fe0b1e721e5e4fb8e4bcd9e50f10b570f628/hydra/sequence-diagrams/utxo.jpg"}),"\n",(0,n.jsx)(a.h4,{id:"query-protocol-parameters",children:"Query Protocol Parameters"}),"\n",(0,n.jsx)(a.p,{children:"Hydra can use its own custom protocol parameters, and it's common to set the transaction fees to zero in these settings to optimize token usage and reduce costs."}),"\n",(0,n.jsx)("img",{alt:"Query hydra UTxOs sequence diagram",src:"https://raw.githubusercontent.com/dQuadrant/kuber/88c3fe0b1e721e5e4fb8e4bcd9e50f10b570f628/hydra/sequence-diagrams/protocol-parameters.jpg"}),"\n",(0,n.jsx)(a.h4,{id:"abort-head",children:"Abort Head"}),"\n",(0,n.jsx)(a.p,{children:"Aborting a Hydra head is a process initiated on the mainchain during the setup phase if the head initialization fails. This failure typically occurs when not all head members successfully post their commit transactions to lock their UTxOs into the head. A party can then post an abort transaction on the mainchain. This transaction transitions the mainchain state machine directly from the initial state to the final state, bypassing the open and closed states. The abort transaction ensures that any UTxOs that were successfully committed are returned to the mainchain and that the head's unique participation tokens are burned, effectively cancelling the head creation and cleaning up the onchain state."}),"\n",(0,n.jsx)("img",{alt:"Abort hydra head sequence diagram",src:"https://raw.githubusercontent.com/dQuadrant/kuber/88c3fe0b1e721e5e4fb8e4bcd9e50f10b570f628/hydra/sequence-diagrams/abort.jpg"}),"\n",(0,n.jsx)(a.h4,{id:"fanout-head",children:"Fanout Head"}),"\n",(0,n.jsx)(a.p,{children:"Finally, after the contestation period, a fanout transaction transitions the state machine to the final state, placing the definitive set of UTxOs from the head back onto the mainchain, effectively replacing the initial set that was committed."}),"\n",(0,n.jsx)("img",{alt:"Fanout hydra head sequence diagram",src:"https://raw.githubusercontent.com/dQuadrant/kuber/88c3fe0b1e721e5e4fb8e4bcd9e50f10b570f628/hydra/sequence-diagrams/fanout.jpg"})]})}function l(e={}){const{wrapper:a}={...(0,s.R)(),...e.components};return a?(0,n.jsx)(a,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}}}]);