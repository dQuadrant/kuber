<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-sequenceDiagrams" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Sequence Diagrams | Kuber-Hydra</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://cadanoapi.github.io/kuber/hydra_docusaurus/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://cadanoapi.github.io/kuber/hydra_docusaurus/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://cadanoapi.github.io/kuber/hydra_docusaurus/docs/sequenceDiagrams"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Sequence Diagrams | Kuber-Hydra"><meta data-rh="true" name="description" content="Interaction with Hydra"><meta data-rh="true" property="og:description" content="Interaction with Hydra"><link data-rh="true" rel="icon" href="/kuber/hydra_docusaurus/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://cadanoapi.github.io/kuber/hydra_docusaurus/docs/sequenceDiagrams"><link data-rh="true" rel="alternate" href="https://cadanoapi.github.io/kuber/hydra_docusaurus/docs/sequenceDiagrams" hreflang="en"><link data-rh="true" rel="alternate" href="https://cadanoapi.github.io/kuber/hydra_docusaurus/docs/sequenceDiagrams" hreflang="x-default"><link rel="stylesheet" href="/kuber/hydra_docusaurus/assets/css/styles.dd239764.css">
<script src="/kuber/hydra_docusaurus/assets/js/runtime~main.2a899c51.js" defer="defer"></script>
<script src="/kuber/hydra_docusaurus/assets/js/main.5ed23b36.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/kuber/hydra_docusaurus/"><div class="navbar__logo"><img src="/kuber/hydra_docusaurus/img/logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/kuber/hydra_docusaurus/img/logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Kuber-Hydra</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/kuber/hydra_docusaurus/docs/architecture">Architecture</a><a class="navbar__item navbar__link" href="/kuber/hydra_docusaurus/docs/scenarioTests">Scenario Tests</a><a class="navbar__item navbar__link" href="/kuber/hydra_docusaurus/docs/milestones">Milestones</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/dQuadrant/kuber/tree/feat/hydra" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/kuber/hydra_docusaurus/docs/architecture">Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/kuber/hydra_docusaurus/docs/sequenceDiagrams">Sequence Diagrams</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/kuber/hydra_docusaurus/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Sequence Diagrams</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Sequence Diagrams</h1></header>
<p>Interaction with Hydra</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="initialize-head">Initialize Head<a href="#initialize-head" class="hash-link" aria-label="Direct link to Initialize Head" title="Direct link to Initialize Head">​</a></h4>
<p>Initialization of a Hydra head is the process of setting up the offchain state channel for a group of parties. It begins with an initiator posting an initial transaction on the mainchain, which defines the head members and parameters, and forges unique participation tokens for each member.
<img decoding="async" loading="lazy" alt="Initialize Head" src="/kuber/hydra_docusaurus/assets/images/init-76fdb7c72b1c2512e4f8bff73f2abaf8.jpg" width="813" height="452" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="commit-utxos">Commit UTxOs<a href="#commit-utxos" class="hash-link" aria-label="Direct link to Commit UTxOs" title="Direct link to Commit UTxOs">​</a></h4>
<p>Each member locks their chosen UTxOs onchain by posting a commit transaction, utilizing their participation token. Finally, a collectCom transaction is posted to aggregate all committed UTxOs into the initial head state and transition the mainchain state machine to the &quot;open&quot; state, enabling offchain processing to commence.
<img decoding="async" loading="lazy" alt="Commit UTxOs" src="/kuber/hydra_docusaurus/assets/images/commit-de52ebecf64b267f44ee04e8491d323c.jpg" width="919" height="452" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="decommit-utxos">DeCommit UTxOs<a href="#decommit-utxos" class="hash-link" aria-label="Direct link to DeCommit UTxOs" title="Direct link to DeCommit UTxOs">​</a></h4>
<p>Decommitting a UTxO in Hydra means moving it out of the offchain head protocol and back onto the mainchain. This effectively makes the funds or state represented by that UTxO available for standard layer-one operations again. Decommitment can occur when the head is closed, settling the final set of UTxOs back onchain, or incrementally while the head remains open, allowing specific UTxOs to be removed without closing the entire head.
<img decoding="async" loading="lazy" alt="DeCommit UTxOs" src="/kuber/hydra_docusaurus/assets/images/decommit-b6b5747661fca24e0cff5a228e553e14.jpg" width="979" height="963" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="close-head">Close Head<a href="#close-head" class="hash-link" aria-label="Direct link to Close Head" title="Direct link to Close Head">​</a></h4>
<p>Closing a Hydra head means terminating the offchain state channel and settling the final agreed-upon state back onto the mainchain. This process is typically initiated by a head member posting a close transaction on the mainchain, which transitions the mainchain state machine from the open state to the closed state. This transaction includes a certificate representing that party&#x27;s view of the latest confirmed offchain state.
<img decoding="async" loading="lazy" alt="Close Head" src="/kuber/hydra_docusaurus/assets/images/close-60994af355a16a24d344ce626772c985.jpg" width="813" height="452" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="query-utxos">Query UTxOs<a href="#query-utxos" class="hash-link" aria-label="Direct link to Query UTxOs" title="Direct link to Query UTxOs">​</a></h4>
<p>Hydra head maintains a record of available UTxOs that can be spent.
<img decoding="async" loading="lazy" alt="Query UTxOs" src="/kuber/hydra_docusaurus/assets/images/utxo-caa1b9f96c545bd1a3ef3ec9755eb8cb.jpg" width="679" height="452" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="query-protocol-parameters">Query Protocol Parameters<a href="#query-protocol-parameters" class="hash-link" aria-label="Direct link to Query Protocol Parameters" title="Direct link to Query Protocol Parameters">​</a></h4>
<p>Hydra can use its own custom protocol parameters, and it&#x27;s common to set the transaction fees to zero in these settings to optimize token usage and reduce costs.
<img decoding="async" loading="lazy" alt="Query Protocol Parameters" src="/kuber/hydra_docusaurus/assets/images/protocol-parameters-4c51c708bff8d8f4505380c64dc867e2.jpg" width="679" height="452" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="abort-head">Abort Head<a href="#abort-head" class="hash-link" aria-label="Direct link to Abort Head" title="Direct link to Abort Head">​</a></h4>
<p>Aborting a Hydra head is a process initiated on the mainchain during the setup phase if the head initialization fails. This failure typically occurs when not all head members successfully post their commit transactions to lock their UTxOs into the head. A party can then post an abort transaction on the mainchain. This transaction transitions the mainchain state machine directly from the initial state to the final state, bypassing the open and closed states. The abort transaction ensures that any UTxOs that were successfully committed are returned to the mainchain and that the head&#x27;s unique participation tokens are burned, effectively cancelling the head creation and cleaning up the onchain state.
<img decoding="async" loading="lazy" alt="Abort Head" src="/kuber/hydra_docusaurus/assets/images/abort-83719c858837c52ec0661db49964f1f9.jpg" width="813" height="452" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="fanout-head">Fanout Head<a href="#fanout-head" class="hash-link" aria-label="Direct link to Fanout Head" title="Direct link to Fanout Head">​</a></h4>
<p>Finally, after the contestation period, a fanout transaction transitions the state machine to the final state, placing the definitive set of UTxOs from the head back onto the mainchain, effectively replacing the initial set that was committed.
<img decoding="async" loading="lazy" alt="Fanout Head" src="/kuber/hydra_docusaurus/assets/images/fanout-3aa58b0af9e401964004765fcfb8ed15.jpg" width="813" height="452" class="img_ev3q"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/dQuadrant/kuber/tree/feat/hydra/docs/sequenceDiagrams.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/kuber/hydra_docusaurus/docs/architecture"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Architecture</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Kuber Hydra</div></div></div></footer></div>
</body>
</html>